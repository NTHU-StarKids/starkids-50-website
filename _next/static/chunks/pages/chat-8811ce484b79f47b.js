(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[180],{8984:function(e,t,l){(window.__NEXT_P=window.__NEXT_P||[]).push(["/chat",function(){return l(2081)}])},2081:function(e,t,l){"use strict";l.r(t),l.d(t,{default:function(){return w}});var a=l(5893),n=l(7484),r=l.n(n),s=l(7294),i=l(7814),o=l(9398),c=l(7348),d=l(9383),f=l(7978),u=l(1287),m=l(9843),p=[{id:"02c5688d-87f5-4be1-abb6-5ae2e751763e",sentAt:"2021-10-25T16:18:48.914Z",name:"\u5431\u5431\u74dc",text:"\u6211\u662f\u982d\u9999\uff01\u5929\u6587\u793e\u751f\u65e5\u5feb\u6a02~",profile:"profile-04"},{id:"574feaaf-9103-439b-9c81-8b0e7e6aef3c",sentAt:"2021-10-25T17:23:13.074Z",name:"An-Ting Hsu",text:"\u6e05\u5927\u5929\u6587\u793e50\u751f\u65e5\u5feb\u6a02\uff01\uff01",profile:"profile-11"},{id:"4621c591-3a68-4e6d-8e43-8e19eabc5c46",sentAt:"2021-10-27T21:41:52.505Z",name:"Zack\u5468",text:"\u8acb\u554f\u751f\u65e5\u79ae\u7269\u8981\u9001\u54ea?",profile:"profile-01"},{id:"72c3ccaf-379b-4c34-ae1f-bf61a3b33829",sentAt:"2021-10-28T13:37:08.432Z",name:"\u533f\u540d",text:"\u5f90\u7e3dM",profile:"profile-08"},{id:"fde46fe1-e59d-4151-891d-15e32a43b664",sentAt:"2021-10-29T03:59:58.479Z",name:"Zack\u5468",text:"\u6628\u65e5\u9001\u4e8620+\u500b\u661f\u5ea7\u76e4, \u653e\u5728\u793e\u7aa9\u9580\u53e3. \u8acb\u7b11\u7d0d~~",profile:"profile-01"},{id:"e17e758a-7651-4915-961c-ab129092ee2f",sentAt:"2021-11-01T15:57:19.442Z",name:"\u96b1\u85cf\u65bc\u9ed1\u591c\u4e2d\u7684\u661f\u7a7a\u4e4b\u5b50",text:"\u600e\u9ebc\u90fd\u6c92\u6709\u4eba\u7559\u8a00\u5462\uff1f50\u6b72\u751f\u65e5\u5feb\u6a02~",profile:"profile-05"},{id:"6bbcb1cf-3129-4eba-98b9-81c8af4092a1",sentAt:"2021-11-02T02:45:34.253Z",name:"\u7334\u5b50\u82b1",text:"\u6700\u8fd1\u7684\u6211\u9700\u8981\u4e00\u9ede\u9152\u7cbe",profile:"profile-06"},{id:"92222b39-7bbe-48e3-9090-e172a5f44cbe",sentAt:"2021-11-03T17:10:45.428Z",name:"\u55b5\u55b5",text:"50\u9031\u5e74\u4e86\u8036\u597d\u611f\u52d5",profile:"profile-09"},{id:"c7e1c90d-f27a-4ab2-9c87-e1ad460e372f",sentAt:"2021-11-05T13:07:58.688Z",name:"\u6797\u5bcc\u6e90",text:"\u795d\u8cc0\u6bcd\u6821\u5929\u6587\u793e\u751f\u65e5!",profile:"profile-01"},{id:"dd725a11-e0d5-484f-823d-0e57d5fdb94e",sentAt:"2021-11-10T07:12:12.029Z",name:"Wink",text:"\u7c4c\u8fa6\u793e\u6176\u597d\u7d2f\u597d\u82b1\u9322\u3002",profile:"profile-01"},{id:"026e3387-9e94-4c8d-944a-fff770e173dc",sentAt:"2021-11-10T07:13:27.304Z",name:"\u5085\u55bb",text:"\u60f3\u8acb\u554f Zack\u5468\u662f\u54ea\u4e00\u4f4d\uff1f",profile:"profile-03"},{id:"02679894-83b4-43c3-80a1-e2fc2e05bc44",sentAt:"2021-11-21T12:35:20.283Z",name:"Totoro",text:"\u6211\u4f86\u7c3d\u540d\u4e00\u4e0b",profile:"profile-08"},{id:"c25234ea-2cff-4cb1-aaf2-6d2776b95a5d",sentAt:"2021-11-25T08:49:01.294Z",name:"\u533f\u540d",text:"\u8acb\u554f\u4eca\u5e74\u662f\u5426\u4e5f\u6703\u516c\u5e03\u6536\u652f\u6e05\u55ae?",profile:"profile-04"},{id:"e01258d5-8a45-4ac6-9eba-35eb323d2d90",sentAt:"2021-12-02T05:05:08.319Z",name:"\u5927\u72d7",text:"\u770b\u5230\u81ea\u5df1\u7576\u5e74\u5beb\u7684\u793e\u8a8c\uff0c\u9a5a\u5687\u6307\u6578\u98c6\u5347\uff01\uff01\u5b78\u5f1f\u59b9\u592a\u6709\u5fc3\u4e86\uff0c\u8b1d\u8b1d\u8b93\u6211\u56de\u5473\u7576\u5e74\u9752\u6625......",profile:"profile-01"},{id:"ef4aa6f6-5488-4000-88b2-a38f69b6e51b",sentAt:"2021-12-16T17:11:22.953Z",name:"\u55b5\u55b5",text:"\u5982\u679c\u9084\u60f3\u56de\u5473\u66f4\u591a\u793e\u8a8c\u7d30\u7bc0\uff0c\u6b61\u8fce\u76f4\u63a5\u5bc4\u4fe1\u8ddf\u793e\u5718\u806f\u7d61\u5594\uff01",profile:"profile-01"}];function x(e,t,l){return t in e?Object.defineProperty(e,t,{value:l,enumerable:!0,configurable:!0,writable:!0}):e[t]=l,e}var h="profile-01",b=function(e){var t=e.name,l=e.profileUrl,n=e.isSelf,s=e.sentAt,i=e.messages;return(0,a.jsxs)("div",{className:"flex w-full sm:w-5/6 md:w-4/5 lg:w-2/3 ".concat(n?"flex-row-reverse ml-auto":""),children:[(0,a.jsx)("div",{className:"w-8 md:w-12",children:(0,a.jsx)("div",{className:"relative w-8 md:w-12 h-8 md:h-12 rounded-full bg-center bg-cover",style:{backgroundImage:"url('".concat(l,"')")}})}),(0,a.jsx)("div",{className:"w-full text-left px-2 md:px-3",children:i.map((function(e,l){return(0,a.jsxs)("div",{className:"font-light",children:[0==l&&(n?(0,a.jsxs)("p",{className:"tracking-wide text-gray-50 leading-4 text-right cursor-default select-none",children:[(0,a.jsx)("span",{className:"mr-2 text-sm text-gray-200",children:r()(s).format("YYYY/MM/DD HH:mm")}),t]}):(0,a.jsxs)("p",{className:"tracking-wide text-gray-50 leading-4 cursor-default select-none",children:[t,(0,a.jsx)("span",{className:"ml-2 text-sm text-gray-200",children:r()(s).format("YYYY/MM/DD HH:mm")})]})),(0,a.jsx)("div",{className:"w-full flex ".concat(n?"justify-end":"justify-start"),children:(0,a.jsx)("div",{className:"mt-1 p-3 rounded-2xl tracking-wide ".concat(n?"bg-purple-600 text-white":"bg-white text-black"," ").concat(0==l?n?"rounded-tr-none":"rounded-tl-none":""),title:r()(s).format("YYYY/MM/DD HH:mm:ss"),children:(0,a.jsx)(f.Z,{text:e.text})})})]},"message-".concat(l))}))})]})},g=function(e){var t=e.disabled,l=e.messageGroups,n=(0,s.useState)(""),r=n[0],f=n[1],u=(0,s.useState)("")[0],p=(0,s.useState)(h),g=p[0],w=p[1],v=(0,s.useRef)(),j=(0,s.useRef)();return(0,s.useEffect)((function(){var e=localStorage.getItem("profile")||h,t=m.hm.findIndex((function(t){return t==e}));-1===t?localStorage.setItem("profile",h):w(m.hm[t]);var l=localStorage.getItem("chatNickname");l&&f(l)}),[]),(0,a.jsxs)(d.Z,{children:[(0,a.jsx)(c.H2,{className:"mb-10",children:"\u7559\u8a00\u677f"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("div",{className:"absolute w-full -top-4 flex justify-center z-30",children:(0,a.jsx)("div",{className:"rounded-full bg-purple-500 h-8 px-4 py-2 text-base sm:text-lg leading-4 sm:leading-4 tracking-wider select-none",children:t?(0,a.jsx)(i.G,{className:"animate-spin h-4 mx-2 inline",icon:o.UO1}):"\u6e05\u5927\u5929\u658750\u5e74\u751f\u65e5\u5feb\u6a02 \ud83c\udf89"})}),(0,a.jsxs)("div",{className:"relative bg-gray-600 w-full h-116 sm:h-132 md:h-148 lg:h-164 xl:h-180 2xl:h-200 rounded-xl",children:[(0,a.jsxs)("div",{className:"absolute left-0 bottom-24 w-full h-92 sm:h-108 md:h-124 lg:h-140 xl:h-156 2xl:h-176 overflow-hidden",children:[(0,a.jsx)("div",{className:"absolute top-0 w-full h-full flex place-content-center transition-opacity duration-700 z-10 opacity-100 ".concat(t?"":"opacity-0"),children:(0,a.jsx)("svg",{className:"my-auto animate-spin h-10 w-10 rounded-full bg-transparent border-4 border-purple-500 border-opacity-90",viewBox:"0 0 24 24",style:{borderRightColor:"#F8F7FD"}})}),(0,a.jsx)("div",{className:"absolute w-full h-full z-20 transition-opacity duration-700 ".concat(t?"opacity-0":"opacity-100"),children:(0,a.jsx)("div",{className:"absolute bottom-0 w-full px-0.5 pt-2 pb-1 overflow-hidden",children:(0,a.jsx)("div",{className:"w-full max-h-88 sm:max-h-104 md:max-h-120 lg:max-h-136 xl:max-h-152 2xl:max-h-172 flex flex-col gap-4 px-2 pb-3 pt-6 lg:p-4 overflow-x-hidden overflow-y-scroll",children:l.map((function(e,t){return(0,a.jsx)(b,function(e){for(var t=1;t<arguments.length;t++){var l=null!=arguments[t]?arguments[t]:{},a=Object.keys(l);"function"===typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(l).filter((function(e){return Object.getOwnPropertyDescriptor(l,e).enumerable})))),a.forEach((function(t){x(e,t,l[t])}))}return e}({},e),"messageGroup-".concat(t))}))})})})]}),(0,a.jsx)("div",{className:"absolute left-0 bottom-0 w-full h-24 border-t-2 border-gray-500 px-2 md:px-4 py-2 select-none",children:(0,a.jsxs)("div",{className:"flex gap-1 h-full",children:[(0,a.jsx)("div",{className:"flex w-12 md:w-16 h-full",children:(0,a.jsx)("div",{className:"relative self-center w-12 md:w-16 h-12 md:h-16 rounded-full bg-center bg-cover ".concat(t?"cursor-not-allowed":"cursor-pointer"),style:{backgroundImage:"url('/img/profile/".concat(g,".png')")},onClick:function(){if(!t){var e=m.hm.findIndex((function(e){return e==g}));-1===e||e===m.hm.length-1?(w(m.hm[0]),localStorage.setItem("profile",m.hm[0])):(w(m.hm[e+1]),localStorage.setItem("profile",m.hm[e+1]))}},children:(0,a.jsx)("div",{className:"absolute right-0 bottom-0 w-6 h-6 rounded-full p-1 ".concat(t?"bg-gray-400":"bg-purple-500"),children:(0,a.jsx)(i.G,{icon:o.V$d})})})}),(0,a.jsxs)("div",{className:"w-full h-full flex flex-col gap-2 pl-1 md:pl-2",children:[(0,a.jsx)("div",{className:"w-full sm:w-1/2 h-9 bg-white rounded-full px-3.5 overflow-hidden",children:(0,a.jsx)("input",{type:"text",className:"form-input w-full h-full px-0 rounded placeholder-gray-400 text-black tracking-wider border-none outline-none focus:ring-0 focus:ring-transparent",name:"nickname",placeholder:"\u540d\u5b57/\u66b1\u7a31",disabled:!0,autoComplete:"off",value:r})}),(0,a.jsxs)("div",{className:"relative flex justify-between gap-1 w-full h-9 bg-white rounded-full pl-3.5 pr-0.5 overflow-hidden",children:[(0,a.jsx)("div",{className:"w-full no-scrollbar overflow-y-scroll",style:{marginTop:"0.4rem"},children:(0,a.jsx)("textarea",{className:"form-textarea w-full h-full p-0 rounded placeholder-gray-400 text-black tracking-wider border-none outline-none focus:ring-0 focus:ring-transparent",name:"message",autoFocus:!0,placeholder:"\u7559\u8a00\u529f\u80fd\u5df2\u95dc\u9589...",disabled:!0,autoComplete:"off",ref:v})}),(0,a.jsx)("div",{className:"flex w-8 h-9",children:(0,a.jsx)("div",{className:"w-8 h-8 self-center rounded-full p-1.5 pl-1 ".concat(!t&&u&&u.split(/\n|\r|\r\n/g).join("")?"bg-purple-500 cursor-pointer":"bg-gray-400 cursor-not-allowed"),children:(0,a.jsx)(i.G,{icon:o.XCy})})}),(0,a.jsx)("button",{className:"hidden invisable",ref:j})]})]})]})})]})]})]})};function w(){var e=(0,s.useState)([]),t=e[0],l=e[1],n=(0,s.useState)(!0),i=n[0],o=n[1];return(0,s.useEffect)((function(){var e,t=function(){var e=JSON.parse(localStorage.getItem("chatIds"));return e||localStorage.setItem("chatIds",JSON.stringify([])),e||[]}(),a=function(e){return{id:e.id,name:e.name,profileUrl:"/img/profile/".concat(e.profile,".png"),isSelf:t.includes(e.id),sentAt:e.sentAt,messages:[{sentAt:e.sentAt,text:e.text}]}},n=[];p.forEach((function(l,s){if(0!=s){if(!(r()(l.sentAt).diff(r()(e.sentAt))<3e5&&(t.includes(l.id)&&t.includes(e.id)||!t.includes(l.id)&&!t.includes(e.id)&&l.name==e.name)))return n.push(e),e=a(l),void(s==p.length-1&&n.push(e));var i={sentAt:l.sentAt,text:l.text};e.messages.push(i),s==p.length-1&&n.push(e)}else e=a(l)})),l(n)}),[]),(0,s.useEffect)((function(){setTimeout((function(){o(!1)}),1200)}),[]),(0,a.jsx)(u.Z,{title:"\u7559\u8a00\u677f",metadata:{description:"\u7559\u8a00\u677f"},children:(0,a.jsx)(g,{disabled:i,messageGroups:t})})}}},function(e){e.O(0,[523,515,27,287,774,888,179],(function(){return t=8984,e(e.s=t);var t}));var t=e.O();_N_E=t}]);